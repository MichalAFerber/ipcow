---
layout: page
title: DNS Lookup
subtitle: List all DNS records for a domain.
share-description: "IP Cow is a free service that shows you the public IP address of your device along with information about your computer and web browser. IP Cow also offers an Ookla Speedtest and other network resources and tools."
# full-width: true
---
<div class="container justify-content-center">
  <form method="GET" action="/api/dns-lookup.php">
    <div class="form-label-group">
      <input type="text" class="form-control" id="domain" name="domain" placeholder="example.com" required autofocus>
      <label for="domain">example.com</label>
    </div>
    <div class="form-group text-center">
      <button type="submit" class="btn btn-lg btn-primary btn-block">Check DNS</button>
    </div>
    <div id="hcaptcha-widget" class="h-captcha" data-sitekey="1eb25e26-63d0-476a-bcb6-ae62a2b04752"
      data-size="invisible" data-callback="hcaptchaVerifyCallback"></div>
  </form>
</div>

<div id="dns-results" style="display: none;"></div>

<!-- Load hCaptcha and custom module -->
<script src="https://js.hcaptcha.com/1/api.js" async defer></script>
<script src="/assets/js/hcaptcha-module.js" defer></script>

<script>
  document.querySelector('form').addEventListener('submit', async (e) => {
    e.preventDefault();
    const domain = document.getElementById('domain').value;
    const resultsDiv = document.getElementById('dns-results');
    resultsDiv.innerHTML = 'Loading...';

    try {
      const startTime = performance.now();
      const response = await fetch(`/api/dns-lookup.php?domain=${encodeURIComponent(domain)}`);
      const endTime = performance.now();
      const latency = (endTime - startTime).toFixed(2);

      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }

      const data = await response.json();

      if (!data.success || data.error) {
        resultsDiv.innerHTML = data.error || 'No DNS records found.';
        return;
      }

      const records = data.records || [];
      const typeMap = {
        '1': 'A', '28': 'AAAA', '15': 'MX', '2': 'NS', '16': 'TXT', '6': 'SOA', '65': 'HTTPS', '257': 'CAA', '13': 'HINFO'
      };

      let formatted = '<table>';
      formatted += '<tr><th>Metric</th><th>Value</th></tr>';
      formatted += `<tr><td>Domain</td><td>${domain}</td></tr>`;
      formatted += `<tr><td>Client Latency</td><td>${latency} ms</td></tr>`;
      formatted += '<tr><td colspan="2"><strong>DNS Records</strong></td></tr>';
      formatted += '<tr><th>Type</th><th>Value</th></tr>';

      records.forEach(record => {
        if (record.type && typeMap[record.type]) {
          const type = typeMap[record.type];
          const value = record.data || '';
          if (value.toLowerCase() !== 'rfc8482' || type === 'HINFO') {
            if (value) {
              formatted += `<tr><td>${type}</td><td>${value}</td></tr>`;
            }
          }
        }
      });

      formatted += '</table>';
      resultsDiv.innerHTML = records.length > 0 ? formatted : 'No DNS records found for this domain.';

      // Add export button
      if (records.length > 0) {
        const exportBtn = document.createElement('button');
        exportBtn.textContent = 'Download JSON';
        exportBtn.style.marginTop = '20px';
        exportBtn.className = 'btn btn-primary';
        exportBtn.onclick = () => {
          const exportData = {
            domain: domain,
            latency: `${latency} ms`,
            records: records
          };
          const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = `${domain}_dns_records.json`;
          a.click();
          URL.revokeObjectURL(url);
        };
        resultsDiv.appendChild(exportBtn);
      }

    } catch (error) {
      console.error('Error in DNS lookup:', error);
      resultsDiv.innerHTML = `Error: ${error.message}. Please check the domain and try again.`;
    }
  });
</script>